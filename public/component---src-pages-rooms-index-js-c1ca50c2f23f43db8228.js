(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{147:function(e,t,n){"use strict";n.r(t);n(42),n(163),n(164),n(74);var a=n(162),r=n.n(a),o=(n(171),n(39),n(160),n(165)),i=n.n(o),c=(n(161),n(7)),s=n.n(c),l=n(0),u=n.n(l),p=n(172),m=n(156),h=n(154),d=(n(167),function(e){function t(){for(var t,n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return(t=e.call.apply(e,[this].concat(a))||this).state={id:null,name:"Loading...",occupancy_count:0,doors:0,page:0,history:[]},t.loadHistory=function(e){e&&e.preventDefault();var n=t.state.page,a=t.state.history;return fetch("/api/1/logs/room/"+t.state.id+"?size=50&page="+n).then(function(e){return e.json()}).then(function(e){return t.setState({history:a.concat(e),page:n+1}),e}).then(function(e){e.length<50&&document.getElementById("loadmore").remove()}),!1},t.setOcc=function(e){e.preventDefault();var n=t.state.occupancy_count;if(n=prompt("How many people are in "+t.state.name+"?",n-1),n=parseInt(n),!(isNaN(n)||n<=0))return n>100&&(n=100),fetch("/api/1/rooms/"+t.state.id,{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({occupancy_count:n})}).then(function(e){return e.json()}).then(function(e){return t.setState({occupancy_count:e.occupancy_count})}),!1},t}s()(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=i()(r.a.mark(function e(){var t,n,a,o;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=new URL(document.location).searchParams,n=t.get("id"),e.next=4,fetch("/api/1/rooms/"+n).then(function(e){return e.json()});case 4:a=e.sent,this.setState(a),(o=Object(p.connect)("ws://"+window.location.host+":1884")).on("connect",function(){o.subscribe("hiome/1/sensor/"+n+":occupancy",{qos:1}),o.subscribe("hiome/1/log",{qos:1})}),o.on("message",function(e,t,a){var r=JSON.parse(t.toString());if(e==="hiome/1/sensor/"+n+":occupancy")"occupancy"===r.meta.type&&"gateway"===r.meta.source&&this.setState({occupancy_count:r.val});else if("hiome/1/log"===e&&"room"===r.device_type&&r.device_id===n){var o={id:(new Date).getTime(),event_type:r.val,object_type:r.device_type,object_id:r.device_id,message:r.message,level:r.level,occurred_at:new Date},i=this.state.history;i.unshift(o),this.setState({history:i})}}.bind(this)),this.loadHistory();case 10:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),n.people=function(){return 1===this.state.occupancy_count?"person":"people"},n.are=function(){return 1===this.state.occupancy_count?"is":"are"},n.historyRow=function(e){return u.a.createElement("div",{key:e.id,className:"historyRow "+e.level},u.a.createElement("span",{className:"time"},this.strftime("%l:%M %p",new Date(e.occurred_at))),u.a.createElement("span",{className:"message"},e.message))},n.renderHistory=function(){if(this.state.history.length>0){var e=[],t=null,n=this.state.history,a=Array.isArray(n),r=0;for(n=a?n:n[Symbol.iterator]();;){var o;if(a){if(r>=n.length)break;o=n[r++]}else{if((r=n.next()).done)break;o=r.value}var i=o,c=this.strftime("%A, %B %e%t",new Date(i.occurred_at));c!==t&&(t=c,e.push(u.a.createElement("h3",{key:c},c))),e.push(this.historyRow(i))}return e}return u.a.createElement("h2",{style:{textAlign:"center",color:"#A17EDF",margin:"100px"}},"No history found.")},n.render=function(){return u.a.createElement(m.a,{goBack:!0},u.a.createElement(h.a,{title:this.state.name}),u.a.createElement("div",{className:"headline"},u.a.createElement("h1",null,this.state.name),u.a.createElement("p",null,"There ",this.are()," ",u.a.createElement("strong",null,this.state.occupancy_count)," ",this.people()," in here right now. ",u.a.createElement("a",{href:"#",onClick:this.setOcc,title:"Change occupancy count"},"Edit"))),u.a.createElement("div",{className:"page"},u.a.createElement("h2",null,"History"),this.renderHistory(),u.a.createElement("a",{href:"#",id:"loadmore",onClick:this.loadHistory,title:"See older history"},"Load More...")),u.a.createElement("footer",null,"Â© Hiome Inc 2019"))},n.strftime=function(e,t){t instanceof Date||(t=new Date);var n=t.getDay(),a=t.getDate(),r=t.getMonth(),o=t.getFullYear(),i=t.getHours(),c=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],s=["January","February","March","April","May","June","July","August","September","October","November","December"],l=[0,31,59,90,120,151,181,212,243,273,304,334],u=function(){var e=new Date(t);return e.setDate(a-(n+6)%7+3),e},p=function(e,t){return(Math.pow(10,t)+e+"").slice(1)};return e.replace(/%[a-z]/gi,function(e){return({"%a":c[n].slice(0,3),"%A":c[n],"%b":s[r].slice(0,3),"%B":s[r],"%c":t.toUTCString(),"%C":Math.floor(o/100),"%d":p(a,2),"%e":a,"%F":t.toISOString().slice(0,10),"%G":u().getFullYear(),"%g":(u().getFullYear()+"").slice(2),"%H":p(i,2),"%I":p((i+11)%12+1,2),"%j":p(l[r]+a+(r>1&&(o%4==0&&o%100!=0||o%400==0)?1:0),3),"%k":i,"%l":(i+11)%12+1,"%m":p(r+1,2),"%n":r+1,"%M":p(t.getMinutes(),2),"%p":i<12?"AM":"PM","%P":i<12?"am":"pm","%s":Math.round(t.getTime()/1e3),"%S":p(t.getSeconds(),2),"%t":1===a||21===a||31===a?"st":2===a||22===a?"nd":3===a||23===a?"rd":"th","%u":n||7,"%V":function(){var e=u(),t=e.valueOf();e.setMonth(0,1);var n=e.getDay();return 4!==n&&e.setMonth(0,1+(4-n+7)%7),p(1+Math.ceil((t-e)/6048e5),2)}(),"%w":n,"%x":t.toLocaleDateString(),"%X":t.toLocaleTimeString(),"%y":(o+"").slice(2),"%Y":o,"%z":t.toTimeString().replace(/.+GMT([+-]\d+).+/,"$1"),"%Z":t.toTimeString().replace(/.+\((.+?)\)$/,"$1")}[e]||"")+""||e})},t}(l.Component));t.default=d},151:function(e,t,n){var a;e.exports=(a=n(153))&&a.default||a},152:function(e,t,n){"use strict";var a=n(0),r=n.n(a),o=n(4),i=n.n(o),c=n(33),s=n.n(c);n.d(t,"a",function(){return s.a});n(151),r.a.createContext({});i.a.object,i.a.string.isRequired,i.a.func,i.a.func},153:function(e,t,n){"use strict";n.r(t);n(34);var a=n(0),r=n.n(a),o=n(4),i=n.n(o),c=n(55),s=n(2),l=function(e){var t=e.location,n=s.default.getResourcesForPathnameSync(t.pathname);return r.a.createElement(c.a,Object.assign({location:t,pageResources:n},n.json))};l.propTypes={location:i.a.shape({pathname:i.a.string.isRequired}).isRequired},t.default=l},154:function(e,t,n){"use strict";var a=n(155),r=n(0),o=n.n(r),i=n(4),c=n.n(i),s=n(159),l=n.n(s);function u(e){var t=e.description,n=e.lang,r=e.meta,i=e.keywords,c=e.title,s=a.data.site,u=t||s.siteMetadata.description;return o.a.createElement(l.a,{htmlAttributes:{lang:n},title:c,titleTemplate:"%s | "+s.siteMetadata.title,meta:[{name:"description",content:u},{property:"og:title",content:c},{property:"og:description",content:u},{property:"og:type",content:"website"},{name:"twitter:card",content:"summary"},{name:"twitter:creator",content:s.siteMetadata.author},{name:"twitter:title",content:c},{name:"twitter:description",content:u}].concat(i.length>0?{name:"keywords",content:i.join(", ")}:[]).concat(r)})}u.defaultProps={lang:"en",meta:[],keywords:[],description:""},u.propTypes={description:c.a.string,lang:c.a.string,meta:c.a.arrayOf(c.a.object),keywords:c.a.arrayOf(c.a.string),title:c.a.string.isRequired},t.a=u},155:function(e){e.exports={data:{site:{siteMetadata:{title:"Hiome",description:"Your home's personal dashboard.",author:"Hiome Inc"}}}}},156:function(e,t,n){"use strict";var a=n(0),r=n.n(a),o=n(4),i=n.n(o),c=n(7),s=n.n(c),l=n(152),u=(n(157),function(e){function t(){return e.apply(this,arguments)||this}s()(t,e);var n=t.prototype;return n.renderGoBack=function(){if(this.props.goBack)return r.a.createElement(l.a,{to:"/",id:"goBack",title:"Back to Dashboard",style:{float:"left",padding:"1.45rem 1rem 0.5rem 1rem"}},r.a.createElement("svg",{width:"50",height:"40",xmlns:"http://www.w3.org/2000/svg",version:"1.1",x:"0px",y:"0px",viewBox:"0 0 100 125"},r.a.createElement("g",{fill:"#cbb9ec"},r.a.createElement("path",{d:"M 31.9375 20.96875 A 2.0001996 2.0001996 0 0 0 30.5625 21.59375 L 4.5625 48.59375 A 2.0001996 2.0001996 0 0 0 4.5625 51.375 L 30.5625 78.375 A 2.0001996 2.0001996 0 1 0 33.4375 75.59375 L 10.71875 52 L 94 52 A 2.0001996 2.0001996 0 1 0 94 48 L 10.71875 48 L 33.4375 24.375 A 2.0001996 2.0001996 0 0 0 31.9375 20.96875 z "}))))},n.render=function(){return r.a.createElement("header",{style:{marginBottom:"1.45rem"}},this.renderGoBack(),r.a.createElement("div",{style:{margin:"0 auto",maxWidth:200,padding:"1.45rem 0",textAlign:"center"}},r.a.createElement(l.a,{to:"/",style:{color:"white",textDecoration:"none",padding:"20px"}},r.a.createElement("svg",{id:"headerlogo",width:"25px",height:"42px",version:"1.1",viewBox:"0 0 34 57",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink"},r.a.createElement("g",{fill:"#cbb9ec"},r.a.createElement("path",{id:"marka",d:"m23.656 38v19h-2.1738v-9.4473h-8.5449v9.4473h-2.1738v-19h-9.9547v-2.544h8.162v-0.159c-0.98934-0.848-1.9257-1.8462-2.809-2.9945s-1.6695-2.4292-2.3585-3.8425c-0.689-1.4133-1.2367-2.9503-1.643-4.611-0.40634-1.6607-0.6095-3.445-0.6095-5.353 0-2.6853 0.40633-5.1233 1.219-7.314 0.81267-2.1907 1.9345-4.0633 3.3655-5.618 1.431-1.5547 3.1093-2.756 5.035-3.604s4.0015-1.272 6.2275-1.272c2.332 0 4.4432 0.46816 6.3335 1.4045s3.5157 2.2083 4.876 3.816c1.3603 1.6077 2.4115 3.4803 3.1535 5.618 0.742 2.1377 1.113 4.3902 1.113 6.7575 0 1.9787-0.22083 3.8425-0.6625 5.5915s-1.0158 3.3478-1.7225 4.7965-1.5105 2.7295-2.4115 3.8425-1.8108 2.0405-2.7295 2.7825v0.159h8.268v2.544h-9.9598zm-2.1738 0h-0.21542v-1.855c1.06-0.70667 2.1023-1.6077 3.127-2.703s1.9345-2.3762 2.7295-3.8425 1.4398-3.1093 1.9345-4.929 0.742-3.7895 0.742-5.9095c0-1.7313-0.265-3.5157-0.795-5.353-0.53-1.8373-1.3162-3.5068-2.3585-5.0085-1.0423-1.5017-2.3408-2.7295-3.8955-3.6835s-3.3567-1.431-5.406-1.431c-1.9433 0-3.7012 0.40633-5.2735 1.219s-2.9062 1.9257-4.0015 3.339-1.9433 3.0652-2.544 4.9555-0.901 3.9132-0.901 6.0685c0 1.9787 0.24733 3.869 0.742 5.671s1.1395 3.445 1.9345 4.929c0.795 1.484 1.7048 2.8002 2.7295 3.9485 1.0247 1.1483 2.067 2.0582 3.127 2.7295v1.855h-0.2205v7.1875h8.5449v-7.1875z"}))))))},t}(a.Component));u.propTypes={goBack:i.a.bool},u.defaultProps={goBack:!1};var p=u,m=(n(158),function(e){var t=e.children,n=e.goBack;return r.a.createElement(r.a.Fragment,null,r.a.createElement(p,{goBack:n}),r.a.createElement("div",{style:{margin:"0 auto",padding:"0px 0px 1.45rem"}},r.a.createElement("main",null,t)))});m.propTypes={children:i.a.node.isRequired,goBack:i.a.bool},m.defaultProps={goBack:!1};t.a=m}}]);
//# sourceMappingURL=component---src-pages-rooms-index-js-c1ca50c2f23f43db8228.js.map