(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{147:function(t,e,n){"use strict";n.r(e);n(162),n(160),n(161),n(75);var a=n(163),r=n.n(a),o=(n(159),n(164)),i=n.n(o),s=n(7),c=n.n(s),l=n(0),m=n.n(l),u=n(156),d=n(154),p=function(t){function e(){for(var e,n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))||this).state={id:null,settingRoom1:!0,room1:null,room1_name:null,room2:null,room2_name:null,rooms:[]},e.updateRoom=function(t){var n=t.target.value,a=t.target.options[t.target.selectedIndex].text,r=e.state.rooms;if("null"===n&&(n=null,a=null),"new"===n){if(!(a=prompt("What is the name of this room?","Living Room")))return;n=Date.now()/1e3|0,fetch("/api/1/rooms",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({id:n,name:a,occupancy_count:0})}),r.push({id:n,name:a,occupancy_count:0})}e.state.settingRoom1?e.setState({room1:n,room1_name:a,rooms:r}):e.setState({room2:n,room2_name:a,rooms:r})},e.nextRoom=function(){null!==e.state.room1&&e.setState({settingRoom1:!1})},e.saveSensor=i()(r.a.mark(function t(){var n,a;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.state.room2){t.next=5;break}return n="external"===e.state.room1?"":e.state.room1,a="external"===e.state.room2?"":e.state.room2,t.next=5,fetch("/api/1/sensors",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({id:e.state.id,room_id:n+"::"+a,name:e.state.room1_name+" <-> "+e.state.room2_name,type:"door"})}).then(function(t){return window.location.href="/"});case 5:case"end":return t.stop()}},t)})),e}c()(e,t);var n=e.prototype;return n.componentDidMount=function(){var t=i()(r.a.mark(function t(){var e,n;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=new URL(document.location).searchParams,this.setState({id:e.get("id"),room1:e.get("r1"),room2:e.get("r2")}),t.next=4,fetch("/api/1/rooms").then(function(t){return t.json()});case 4:n=t.sent,this.setState({rooms:n});case 6:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),n.formQuestion=function(){return this.state.settingRoom1?m.a.createElement("label",{htmlFor:"name"},"Which room is this sensor in?"):m.a.createElement("label",{htmlFor:"name"},"Now walk through the door. Which room are you in now?")},n.renderButton=function(){return this.state.settingRoom1?m.a.createElement("button",{onClick:this.nextRoom},"Next"):m.a.createElement("button",{onClick:this.saveSensor},"Save")},n.renderRoomOptions=function(){var t=[],e=this.state.rooms,n=Array.isArray(e),a=0;for(e=n?e:e[Symbol.iterator]();;){var r;if(n){if(a>=e.length)break;r=e[a++]}else{if((a=e.next()).done)break;r=a.value}var o=r;(this.state.settingRoom1||o.id!==this.state.room1)&&t.push(m.a.createElement("option",{key:"room"+o.id,value:o.id},o.name))}return t},n.renderExternalOption=function(){if(this.state.settingRoom1||"external"!==this.state.room1)return m.a.createElement("option",{value:"external"},"Outside")},n.renderRoomForm=function(){return null===this.state.id?m.a.createElement("p",null,"Invalid QR Code..."):m.a.createElement("div",null,this.formQuestion(),m.a.createElement("select",{onChange:this.updateRoom,value:this.state.settingRoom1?this.state.room1||"null":this.state.room2||"null"},m.a.createElement("option",{value:"null"},"Select a room..."),this.renderRoomOptions(),this.renderExternalOption(),m.a.createElement("option",{value:"new"},"Add New Room")),this.renderButton())},n.render=function(){return m.a.createElement(u.a,null,m.a.createElement(d.a,{title:"Add Sensor"}),m.a.createElement("h1",{style:{textAlign:"center"}},"Add Sensor"),m.a.createElement("div",{style:{margin:"0 auto",textAlign:"center"}},this.renderRoomForm()))},e}(l.Component);e.default=p},150:function(t,e,n){"use strict";n.d(e,"b",function(){return m});var a=n(0),r=n.n(a),o=n(4),i=n.n(o),s=n(33),c=n.n(s);n.d(e,"a",function(){return c.a});n(151);var l=r.a.createContext({}),m=function(t){return r.a.createElement(l.Consumer,null,function(e){return t.data||e[t.query]&&e[t.query].data?(t.render||t.children)(t.data?t.data.data:e[t.query].data):r.a.createElement("div",null,"Loading (StaticQuery)")})};m.propTypes={data:i.a.object,query:i.a.string.isRequired,render:i.a.func,children:i.a.func}},151:function(t,e,n){var a;t.exports=(a=n(152))&&a.default||a},152:function(t,e,n){"use strict";n.r(e);n(34);var a=n(0),r=n.n(a),o=n(4),i=n.n(o),s=n(55),c=n(2),l=function(t){var e=t.location,n=c.default.getResourcesForPathnameSync(e.pathname);return r.a.createElement(s.a,Object.assign({location:e,pageResources:n},n.json))};l.propTypes={location:i.a.shape({pathname:i.a.string.isRequired}).isRequired},e.default=l},153:function(t){t.exports={data:{site:{siteMetadata:{title:"Hiome"}}}}},154:function(t,e,n){"use strict";var a=n(155),r=n(0),o=n.n(r),i=n(4),s=n.n(i),c=n(158),l=n.n(c);function m(t){var e=t.description,n=t.lang,r=t.meta,i=t.keywords,s=t.title,c=a.data.site,m=e||c.siteMetadata.description;return o.a.createElement(l.a,{htmlAttributes:{lang:n},title:s,titleTemplate:"%s | "+c.siteMetadata.title,meta:[{name:"description",content:m},{property:"og:title",content:s},{property:"og:description",content:m},{property:"og:type",content:"website"},{name:"twitter:card",content:"summary"},{name:"twitter:creator",content:c.siteMetadata.author},{name:"twitter:title",content:s},{name:"twitter:description",content:m}].concat(i.length>0?{name:"keywords",content:i.join(", ")}:[]).concat(r)})}m.defaultProps={lang:"en",meta:[],keywords:[],description:""},m.propTypes={description:s.a.string,lang:s.a.string,meta:s.a.arrayOf(s.a.object),keywords:s.a.arrayOf(s.a.string),title:s.a.string.isRequired},e.a=m},155:function(t){t.exports={data:{site:{siteMetadata:{title:"Hiome",description:"Your home's personal dashboard.",author:"Hiome Inc"}}}}},156:function(t,e,n){"use strict";var a=n(153),r=n(0),o=n.n(r),i=n(4),s=n.n(i),c=n(150),l=function(t){var e=t.siteTitle;return o.a.createElement("header",{style:{marginBottom:"1.45rem"}},o.a.createElement("div",{style:{margin:"0 auto",maxWidth:960,padding:"1.45rem 1.0875rem"}},o.a.createElement("h1",{style:{margin:0,textAlign:"center"}},o.a.createElement(c.a,{to:"/",style:{color:"white",textDecoration:"none"}},e))))};l.propTypes={siteTitle:s.a.string},l.defaultProps={siteTitle:""};var m=l,u=(n(157),function(t){var e=t.children;return o.a.createElement(c.b,{query:"755544856",render:function(t){return o.a.createElement(o.a.Fragment,null,o.a.createElement(m,{siteTitle:t.site.siteMetadata.title}),o.a.createElement("div",{style:{margin:"0 auto",maxWidth:960,padding:"0px 1.0875rem 1.45rem",paddingTop:0}},o.a.createElement("main",null,e)))},data:a})});u.propTypes={children:s.a.node.isRequired};e.a=u}}]);
//# sourceMappingURL=component---src-pages-sensors-add-js-9d738dc042b24de4c54c.js.map